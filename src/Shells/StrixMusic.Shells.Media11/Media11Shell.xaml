<sdkctrls:Shell
    x:Class="StrixMusic.Shells.Media11.Media11Shell"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:collections="using:StrixMusic.Shells.Media11.Controls.Collections"
    xmlns:controls="using:StrixMusic.Shells.Media11.Controls"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:pages="using:StrixMusic.Shells.Media11.Controls.Pages"
    xmlns:sdkctrls="using:StrixMusic.Sdk.WinUI.Controls"
    xmlns:sdkvms="using:StrixMusic.Sdk.ViewModels"
    xmlns:selectors="using:StrixMusic.Shells.Media11.TemplateSelectors"
    xmlns:tkcontrols="using:CommunityToolkit.WinUI.Controls"
    xmlns:toolkit="using:CommunityToolkit.WinUI"
    xmlns:media="using:Microsoft.UI.Xaml.Media"
    mc:Ignorable="d">

    <sdkctrls:Shell.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="ms-appx:///StrixMusic.Shells.Media11/Resources.xaml" />
            </ResourceDictionary.MergedDictionaries>

            <DataTemplate x:Key="Media11PlaylistsPageDataTemplate" x:DataType="sdkvms:IPlaylistCollectionViewModel">
                <pages:Media11PlaylistsPage PlaylistCollection="{Binding DataContext, Mode=OneTime}" />
            </DataTemplate>

            <selectors:MainContentTemplateSelector x:Key="MainContentTemplateSelector" PlaylistsPageTemplate="{StaticResource Media11PlaylistsPageDataTemplate}">
                <selectors:MainContentTemplateSelector.AlbumPageTemplate>
                    <DataTemplate x:DataType="sdkvms:AlbumViewModel">
                        <pages:Media11AlbumPage Album="{Binding}" />
                    </DataTemplate>
                </selectors:MainContentTemplateSelector.AlbumPageTemplate>
                <selectors:MainContentTemplateSelector.ArtistPageTemplate>
                    <DataTemplate x:DataType="sdkvms:ArtistViewModel">
                        <pages:Media11ArtistPage Artist="{Binding}" />
                    </DataTemplate>
                </selectors:MainContentTemplateSelector.ArtistPageTemplate>
                <selectors:MainContentTemplateSelector.HomePageTemplate>
                    <DataTemplate x:DataType="sdkvms:LibraryViewModel">
                        <pages:Media11HomePage Library="{Binding}" />
                    </DataTemplate>
                </selectors:MainContentTemplateSelector.HomePageTemplate>
                <selectors:MainContentTemplateSelector.PlaylistPageTemplate>
                    <DataTemplate x:DataType="sdkvms:PlaylistViewModel">
                        <pages:Media11PlaylistPage Playlist="{Binding}" />
                    </DataTemplate>
                </selectors:MainContentTemplateSelector.PlaylistPageTemplate>
            </selectors:MainContentTemplateSelector>

            <ResourceDictionary.ThemeDictionaries>
                <ResourceDictionary x:Key="Light">
                    <SolidColorBrush x:Key="ToggleButtonCheckedForeground" Color="Black" />
                    <SolidColorBrush x:Key="ToggleButtonForegroundCheckedPointerOver" Color="Black" />
                    <SolidColorBrush x:Key="ToggleButtonForegroundCheckedPressed" Color="Black" />
                </ResourceDictionary>
                <ResourceDictionary x:Key="Dark">
                    <SolidColorBrush x:Key="ToggleButtonForegroundChecked" Color="White" />
                    <SolidColorBrush x:Key="ToggleButtonForegroundCheckedPointerOver" Color="White" />
                    <SolidColorBrush x:Key="ToggleButtonForegroundCheckedPressed" Color="White" />
                </ResourceDictionary>
            </ResourceDictionary.ThemeDictionaries>
        </ResourceDictionary>
    </sdkctrls:Shell.Resources>

    <Border Background="{ThemeResource PaneHostBackgroundBrush}">
        <Grid Padding="0" CornerRadius="7"
              BorderThickness="1" BorderBrush="{ThemeResource SystemControlBackgroundBaseLowBrush}">

            <Grid.Background>
                <ImageBrush Opacity="0.25" ImageSource="ms-appx:///StrixMusic.Shells.Media11/Resources/Ripple.png"/>
            </Grid.Background>

            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="40"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <Border x:Name="ShadowLayer" Grid.RowSpan="5"/>

            <Grid x:Name="CustomTitleBarBorder" Height="32">
                <Image Source="https://github.com/Arlodotexe/strix-music/raw/refs/heads/main/www/favicon.ico"
                       HorizontalAlignment="Left" Margin="6"/>

                <TextBlock x:Uid="/Resources/AppNameTB"
                           Margin="32,0,0,0"
                           VerticalAlignment="Center"
                           FontSize="14"
                           TextLineBounds="Tight">
                   <!--Foreground="{ThemeResource SystemAltHighColor}">-->
            <!--<toolkit:Effects.Shadow>
                <toolkit:AttachedDropShadow CastTo="{x:Bind ShadowLayer}"
                                            IsMasked="True"
                                            Offset="0" BlurRadius="18" Color="White" />
            </toolkit:Effects.Shadow>-->
                </TextBlock>
            </Grid>

            <Border Grid.Row="1"
                    BorderThickness="0" BorderBrush="{ThemeResource SystemControlBackgroundBaseLowBrush}" CornerRadius="2"/>
            <Border Grid.Row="1" Margin="1"
                    BorderThickness="0" BorderBrush="{ThemeResource SystemControlBackgroundAltMediumHighBrush}" CornerRadius="1"/>

            <Border Grid.Row="1" VerticalAlignment="Top"
                    BorderThickness="1" BorderBrush="{ThemeResource GlassTubeMediumBorderBrush}"
                    Background="{ThemeResource GlassTubeMediumBackgroundBrush}">
                <tkcontrols:Segmented HorizontalAlignment="Center" Style="{StaticResource GlassNavigationSegmentedStyle}"
                                      SelectedIndex="2" SelectionMode="Single"
                                      SelectionChanged="Segmented_SelectionChanged">
                    <tkcontrols:SegmentedItem Content="Now Playing" />
                    <tkcontrols:SegmentedItem Content="Home" />
                    <tkcontrols:SegmentedItem Content="Library" />
                    <tkcontrols:SegmentedItem Content="Playlists" />
                    <!--<controls:SegmentedItem Content="Friends" />-->
                </tkcontrols:Segmented>
            </Border>

            <Grid Grid.Row="1" HorizontalAlignment="Left" Margin="8,0,0,0">
                <Path Margin="12,0,0,0" VerticalAlignment="Center">
                    <Path.Data>
                        <PathGeometry>
                            <PathFigure>
                                <ArcSegment Size="15,15" Point="0,30" RotationAngle="0" />
                                <LineSegment Point="30,30" />
                                <ArcSegment Size="15,15" Point="30,0" RotationAngle="0" />
                                <LineSegment />
                            </PathFigure>
                        </PathGeometry>
                    </Path.Data>
                    <Path.Fill>
                        <LinearGradientBrush StartPoint="0,0" EndPoint="0,0.4">
                            <GradientStop Color="#77000000" Offset="0.0"/>
                            <GradientStop Color="#00000000" Offset="1.0"/>
                        </LinearGradientBrush>
                    </Path.Fill>
                    <Path.Stroke>
                        <LinearGradientBrush StartPoint="0,0.6" EndPoint="0,1.0">
                            <GradientStop Color="#00FFFFFF" Offset="0.0"/>
                            <GradientStop Color="#55FFFFFF" Offset="1.0"/>
                        </LinearGradientBrush>
                    </Path.Stroke>
                </Path>
                
                <StackPanel Spacing="6" Orientation="Horizontal">
                    <Button Click="NavigationBackButton_Click" Style="{StaticResource GlassRoundButtonStyle}">
                        <Viewbox VerticalAlignment="Center" HorizontalAlignment="Center">
                            <Path Data="M14.5 7.6029H4M7.7751 2.5 2.5 7.6029M2.5 7.6029 7.5533 12.5"
                                  StrokeThickness="3.5" StrokeStartLineCap="Round" StrokeEndLineCap="Round">
                                <Path.Stroke>
                                    <LinearGradientBrush StartPoint="0,0" EndPoint="0,0.8">
                                        <GradientStop Color="#FFFFFF" Offset="0.5"/>
                                        <GradientStop Color="#CFCFCF" Offset="1.0"/>
                                    </LinearGradientBrush>
                                </Path.Stroke>
                            </Path>
                        </Viewbox>
                    </Button>

                    <Button Style="{StaticResource GlassRoundButtonStyle}" IsEnabled="False">
                        <Viewbox VerticalAlignment="Center" HorizontalAlignment="Center">
                            <Path Data="M2.5 7.6029H13M9.2249 2.5 14.5 7.6029M14.5 7.6029 9.4467 12.5"
                                  StrokeThickness="3.5" StrokeStartLineCap="Round" StrokeEndLineCap="Round">
                                <Path.Stroke>
                                    <LinearGradientBrush StartPoint="0,0" EndPoint="0,0.8">
                                        <GradientStop Color="#FFFFFF" Offset="0.5"/>
                                        <GradientStop Color="#CFCFCF" Offset="1.0"/>
                                    </LinearGradientBrush>
                                </Path.Stroke>
                            </Path>
                        </Viewbox>
                    </Button>
                </StackPanel>
            </Grid>

            <Grid Grid.Row="2" Height="30"
                  BorderThickness="0,0,0,1" BorderBrush="Black"
                  Background="#AA222222">
                <Border Background="{ThemeResource GlassTubeMediumBackgroundBrush}"
                        BorderThickness="0,0,0,1" BorderBrush="#404040"/>

                <Button HorizontalAlignment="Left" Style="{StaticResource GlassButtonStyle}"
                        Height="24" VerticalAlignment="Center" Margin="2,0,0,0">
                    <StackPanel Orientation="Horizontal" Spacing="8">
                        <Viewbox Height="16" Width="16">
                            <Path StrokeThickness="1" Stroke="#26000000"
                                  Data="M 1.5878906,0.52929688 V 1.5878906 H 0.52929688 V 2.6464844 H 1.5878906 V 3.7050781 H 2.6464844 V 2.6464844 H 3.7050781 V 1.5878906 H 2.6464844 V 0.52929688 Z">
                                <Path.Fill>
                                    <media:RadialGradientBrush GradientOrigin="1,1.5" RadiusX="1.25" RadiusY="1.5875">
                                        <GradientStop Color="{ThemeResource SystemAccentColor}" Offset="0"/>
                                        <GradientStop Color="{ThemeResource SystemAccentColorLight1}" Offset="0.90"/>
                                        <GradientStop Color="{ThemeResource SystemAccentColorLight2}" Offset="1"/>
                                    </media:RadialGradientBrush>
                                </Path.Fill>
                            </Path>
                        </Viewbox>
                        <TextBlock Text="Create Playlist"/>
                    </StackPanel>
                </Button>
            </Grid>

            <Border Grid.Row="3" Background="{ThemeResource SystemChromeMediumLowColor}">
                <ContentControl x:Name="MainContent"
                                HorizontalContentAlignment="Stretch"
                                ContentTemplateSelector="{StaticResource MainContentTemplateSelector}" />
            </Border>

            <controls:Media11NowPlayingBar
                Grid.Row="4"
                Background="Transparent"
                BackgroundColor="Transparent"
                Height="96"
                Devices="{x:Bind Root.Devices, Mode=OneWay}" />
        </Grid>
    </Border>
</sdkctrls:Shell>
